import { buildMap } from './src/map.js'
import { Game } from './src/game.js'

const canvas = document.getElementById('canvas')
const ctx = canvas.getContext('2d')

canvas.width = 600
canvas.height = 800

// X = Player
// * = Power
// R = Ghost Red
// B = Ghost Blue
// O = Ghost Orange
// P = Ghost Pink
const { player, points, boundaries, powers, ghosts } = buildMap([
  ['╔', '═', '═', '═', '═', '═', '═', '═', '═', '╦', '═', '═', '═', '═', '═', '═', '═', '═', '╗'],
  ['║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║'],
  ['║', '*', '╔', '╗', ' ', '╔', '═', '╗', ' ', '║', ' ', '╔', '═', '╗', ' ', '╔', '╗', '*', '║'],
  ['║', ' ', '╚', '╝', ' ', '╚', '═', '╝', ' ', '╽', ' ', '╚', '═', '╝', ' ', '╚', '╝', ' ', '║'],
  ['║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║'],
  ['║', ' ', '╾', '╼', ' ', '╿', ' ', '╾', '═', '╦', '═', '╼', ' ', '╿', ' ', '╾', '╼', ' ', '║'],
  ['║', ' ', ' ', ' ', ' ', '║', ' ', ' ', ' ', '║', ' ', ' ', ' ', '║', ' ', ' ', ' ', ' ', '║'],
  ['╚', '═', '═', '╗', ' ', '╠', '═', '╼', '`', '╽', '`', '╾', '═', '╣', ' ', '╔', '═', '═', '╝'],
  ['`', '`', '`', '║', ' ', '║', '`', '`', '`', '`', '`', '`', '`', '║', ' ', '║', '`', '`', '`'],
  ['═', '═', '═', '╝', ' ', '╽', '`', '╔', '`', 'O', '`', '╗', '`', '╽', ' ', '╚', '═', '═', '═'],
  ['`', '`', '`', '`', ' ', '`', '`', '║', 'R', 'B', 'P', '║', '`', '`', ' ', '`', '`', '`', '`'],
  ['═', '═', '═', '╗', ' ', '╿', '`', '╚', '═', '═', '═', '╝', '`', '╿', ' ', '╔', '═', '═', '═'],
  ['`', '`', '`', '║', ' ', '║', '`', '`', '`', '`', '`', '`', '`', '║', ' ', '║', '`', '`', '`'],
  ['╔', '═', '═', '╝', ' ', '╽', '`', '╾', '═', '╦', '═', '╼', '`', '╽', ' ', '╚', '═', '═', '╗'],
  ['║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║'],
  ['║', ' ', '╾', '╗', ' ', '╾', '═', '╼', ' ', '╽', ' ', '╾', '═', '╼', ' ', '╔', '╼', ' ', '║'],
  ['║', '*', ' ', '║', ' ', ' ', ' ', ' ', ' ', 'X', ' ', ' ', ' ', ' ', ' ', '║', ' ', '*', '║'],
  ['╠', '╼', ' ', '╽', ' ', '╿', ' ', '╾', '═', '╦', '═', '╼', ' ', '╿', ' ', '╽', ' ', '╾', '╣'],
  ['║', ' ', ' ', ' ', ' ', '║', ' ', ' ', ' ', '║', ' ', ' ', ' ', '║', ' ', ' ', ' ', ' ', '║'],
  ['║', ' ', '╾', '═', '═', '╩', '═', '╼', ' ', '╽', ' ', '╾', '═', '╩', '═', '═', '╼', ' ', '║'],
  ['║', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '║'],
  ['╚', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '═', '╝'],
])

const game = new Game({
  ctx,
  player,
  ghosts,
  points,
  boundaries,
  powers,
});

// Add font asynchronically to use it when the game loads
new FontFace(
  'Emulogic',
  'url(./assets/fonts/Emulogic.woff2)'
).load().then((font) => {
  document.fonts.add(font)
  game.init()
})
